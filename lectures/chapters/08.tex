\section{Párování}
\subsection{Definice}\label{parovani}
Je dán neorientovaný graf $G = (V,E, \eps)$. Podmnožina hran $P \subseteq E$ se nazývá \ii{párování}, jestliže v $P$ 
neexistují 2 různé hrany se společným krajním vrcholem (takže vrchol má stupeň max. 1).

\subsection{Vrchol nasycený a volný v párování}\label{nasyceny}
Mějme \hyperref[parovani]{párování} $P$. Vrchol $v$ grafu nazvěme \ii{nasycený} v $P$, pokud existuje hrana $e \in P$ 
incidentní s $v$.

V opačném případě říkáme, že vrchol $v$ je \ii{volný} v $P$.
\begin{figure}[H]
    \centering
    \begin{tikzpicture}[
        red_node/.style={circle, draw=red!70, line width=2pt, fill=red!70, minimum size=1mm, inner sep=0pt},
        blue_node/.style={circle, draw=blue!60, line width=2pt, fill=blue!60, minimum size=1mm, inner sep=0pt},
        purple_node/.style={circle, draw=purple, line width=2pt, fill=purple, minimum size=1mm, inner sep=0pt},
        edge_style/.style={draw=black, line width=1pt, line cap=round}
    ]

        \node[red_node] (r_bot_1) at (0, 0) {};
        \node[red_node] (r_bot_2) at (2, 0) {};
        \node[red_node] (r_bot_3) at (4, 0) {};

        \node[red_node] (r_top_1) at (0, 2.5) {};
        \node[red_node] (r_top_2) at (2, 2.5) {};
        \node[red_node] (r_top_3) at (4, 2.5) {};

        \node[blue_node] (b_left)  at (-1, 3.5) {};
        \node[blue_node] (b_right) at (5, -1.0) {};


        \draw[edge_style] (r_bot_1) -- (r_bot_2) -- (r_bot_3);
        \draw[edge_style] (r_top_1) -- (r_top_2) -- (r_top_3);

        \draw[edge_style] (r_bot_1) -- (r_top_1);
        \draw[edge_style] (r_bot_2) -- (r_top_2);
        \draw[edge_style] (r_bot_3) -- (r_top_3);

        \draw[draw=purple, line width=1pt, line cap=round, decoration={snake, amplitude=.4mm}, decorate] (r_bot_1) -- (r_top_1);
        \draw[draw=purple, line width=1pt, line cap=round, decoration={snake, amplitude=.4mm}, decorate] (r_bot_2) -- (r_top_2);
        \draw[draw=purple, line width=1pt, line cap=round, decoration={snake, amplitude=.4mm}, decorate] (r_bot_3) -- (r_top_3);

        \draw[edge_style] (r_bot_1) -- (r_top_2);
        \draw[edge_style] (r_bot_2) -- (r_top_3);

        \draw[edge_style] (b_left) -- (r_top_1);
        \draw[edge_style] (b_right) -- (r_bot_3);

        \matrix [
            % draw=white,
            % fill=white,
            line width=1pt,
            rounded corners=0pt,
            inner sep=2pt,
            row sep=1pt,
            column sep=5pt,
            right=0.5cm of r_top_3,
            anchor=north west
        ] {
            \node[red_node, scale=0.7] {}; & \node[anchor=west] {nasycený}; \\
            \node[blue_node, scale=0.7] {}; & \node[anchor=west] {volný}; \\
            \node[minimum width=0.6cm] (p_line) {}; 
                \draw[purple, line width=1pt, decoration={snake, amplitude=.3mm, segment length=1.5mm}, decorate] (p_line.west) -- (p_line.east); 
                & \node[anchor=west, font=\small] {párování $P$}; \\
        };
    \end{tikzpicture}
\end{figure}

\subsection{Perfektní párování}\label{perfektniParovani}
\hyperref[parovani]{Párování} $P$ v grafu $G$ nazveme \ii{perfektní párování}, jestliže každý vrchol grafu je 
\hyperref[nasyceny]{nasycen} v $P$. To znamená, že $P$ má $\frac{n}{2}$ hran, kde $n$ je počet vrcholů grafu $G$.

\subsection{Maximální párování}\label{maximalniParovani}
\hyperref[parovani]{Párování} $P$ v grafu $G$ nazveme \ii{maximální párování}, jestliže je nejpočetnější mezi všemi 
párováními v grafu $G$.

\hyperref[perfektniParovani]{Perfektní párování} je jistě maximální. Naopak to neplatí. Existují grafy, které perfektní 
párování nemají --- stačí uvažovat grafy s lichým počtem vrcholů. Ovšem ani grafy se sudým počtem vrcholů nemusí 
perfektní párování obsahovat.

V každém grafu existuje maximální párování. 

\subsection{Střídavá cesta vůči párování \texorpdfstring{$P$}{P}}\label{stridavaCesta}
Je dáno \hyperref[parovani]{párování} $P$ v grafu $G$. \hyperref[stc]{Cesta} $C = e_1, e_2, \dots, e_k$ v grafu $G$ se 
nazývá \ii{střídavá cesta vůči $P$}, jestliže platí následující dvě podmínky:
\begin{enumerate}[1)]
    \item hrany z cesty $C$ střídavě leží a neleží v párování $P$,
    \item jestliže krajní vrchol $v$ cesty $C$ je \hyperref[nasyceny]{nasycen} v $P$, pak $C$ obsahuje i hranu párování 
    $P$, která vrchol $v$ nasycuje.
\end{enumerate}
\begin{figure}[H]
    \centering
    \begin{tikzpicture}[
        red_node/.style={circle, draw=red!70, line width=2pt, fill=red!70, minimum size=1mm, inner sep=0pt},
        blue_node/.style={circle, draw=blue!60, line width=2pt, fill=blue!60, minimum size=1mm, inner sep=0pt},
        purple_node/.style={circle, draw=purple, line width=2pt, fill=purple, minimum size=1mm, inner sep=0pt},
        green_node/.style={circle, draw=green!70!black, line width=2pt, fill=green!70!black, minimum size=1mm, inner sep=0pt},
        edge_style/.style={draw=black, line width=1pt, line cap=round},
        yellow_edge/.style={draw=green!70!black, line width=1pt, line cap=round}
    ]

        \node[red_node] (r_bot_1) at (0, 0) {};
        \node[red_node] (r_bot_2) at (2, 0) {};
        \node[red_node] (r_bot_3) at (4, 0) {};

        \node[red_node] (r_top_1) at (0, 2.5) {};
        \node[red_node] (r_top_2) at (2, 2.5) {};
        \node[red_node] (r_top_3) at (4, 2.5) {};

        \node[blue_node] (b_left)  at (-1, 3.5) {};
        \node[blue_node] (b_right) at (5, -1.0) {};


        \draw[edge_style] (r_bot_1) -- (r_bot_2) -- (r_bot_3);
        \draw[edge_style] (r_top_1) -- (r_top_2) -- (r_top_3);

        \draw[yellow_edge] (r_bot_1) -- (r_top_1);
        \draw[yellow_edge] (r_bot_2) -- (r_top_2);
        \draw[yellow_edge] (r_bot_3) -- (r_top_3);

        \draw[draw=purple, line width=1pt, line cap=round, decoration={snake, amplitude=.4mm}, decorate] (r_bot_1) -- (r_top_1);
        \draw[draw=purple, line width=1pt, line cap=round, decoration={snake, amplitude=.4mm}, decorate] (r_bot_2) -- (r_top_2);
        \draw[draw=purple, line width=1pt, line cap=round, decoration={snake, amplitude=.4mm}, decorate] (r_bot_3) -- (r_top_3);

        \draw[yellow_edge] (r_bot_1) -- (r_top_2);
        \draw[yellow_edge] (r_bot_2) -- (r_top_3);

        \draw[yellow_edge] (b_left) -- (r_top_1);
        \draw[yellow_edge] (b_right) -- (r_bot_3);

        \matrix [
            % draw=white,
            % fill=white,
            line width=1pt,
            rounded corners=0pt,
            inner sep=2pt,
            row sep=1pt,
            column sep=5pt,
            right=0.5cm of r_top_3,
            anchor=north west
        ] {
            \node[red_node, scale=0.7] {}; & \node[anchor=west] {nasycený}; \\
            \node[blue_node, scale=0.7] {}; & \node[anchor=west] {volný}; \\
            \node[minimum width=0.6cm] (p_line) {}; 
                \draw[purple, line width=1pt, decoration={snake, amplitude=.3mm, segment length=1.5mm}, decorate] (p_line.west) -- (p_line.east); 
                & \node[anchor=west, font=\small] {párování $P$}; \\
            \node[minimum width=0.6cm] (g_line) {}; 
                \draw[green!70!black, line width=1pt] (g_line.west) -- (g_line.east); 
                & \node[anchor=west, font=\small] {cesta $C$}; \\
        };
    \end{tikzpicture}
\end{figure}

\subsection{Zlepšující cesta vůči párování \texorpdfstring{$P$}{P}}\label{zlepsujiciCestaPar}
\hyperref[stridavaCesta]{Střídavá cesta} mezi volnými vrcholy se nazývá \ii{zlepšující cesta vůči $P$}.

\subsection{Tvrzení o střídavé cestě}
Jestliže $C$ je \hyperref[stridavaCesta]{střídavá cesta} vůči \hyperref[parovani]{párování} $P$, pak množina hran 
$P^\prime = C \oplus P$ je také párování v $G$.
\ii{Připomeňme, že symetrická diference $A \oplus B$ dvou množin $A, B$ je množina
\begin{equation}
    A \oplus B = (A \cup B) \setminus (A \cap B) = (A \setminus B) \cup (B \setminus A).
\end{equation}
}
\begin{figure}[H]
    \centering
    \begin{minipage}[c]{0.42\textwidth}
            \begin{tikzpicture}[
                red_node/.style={circle, draw=red!70, line width=2pt, fill=red!70, minimum size=1mm, inner sep=0pt},
                blue_node/.style={circle, draw=blue!60, line width=2pt, fill=blue!60, minimum size=1mm, inner sep=0pt},
                purple_node/.style={circle, draw=purple, line width=2pt, fill=purple, minimum size=1mm, inner sep=0pt},
                green_node/.style={circle, draw=green!70!black, line width=2pt, fill=green!70!black, minimum size=1mm, inner sep=0pt},
                edge_style/.style={draw=black, line width=1pt, line cap=round},
                yellow_edge/.style={draw=green!70!black, line width=1pt, line cap=round}
            ]

                \node[red_node] (r_bot_1) at (0, 0) {};
                \node[red_node] (r_bot_2) at (2, 0) {};
                \node[red_node] (r_bot_3) at (4, 0) {};

                \node[red_node] (r_top_1) at (0, 2.5) {};
                \node[red_node] (r_top_2) at (2, 2.5) {};
                \node[red_node] (r_top_3) at (4, 2.5) {};

                \node[blue_node] (b_left)  at (-1, 3.5) {};
                \node[blue_node] (b_right) at (5, -1.0) {};


                \draw[edge_style] (r_bot_1) -- (r_bot_2) -- (r_bot_3);
                \draw[edge_style] (r_top_1) -- (r_top_2) -- (r_top_3);

                \draw[yellow_edge] (r_bot_1) -- (r_top_1);
                \draw[yellow_edge] (r_bot_2) -- (r_top_2);
                \draw[yellow_edge] (r_bot_3) -- (r_top_3);

                \draw[draw=purple, line width=1pt, line cap=round, decoration={snake, amplitude=.4mm}, decorate] (r_bot_1) -- (r_top_1);
                \draw[draw=purple, line width=1pt, line cap=round, decoration={snake, amplitude=.4mm}, decorate] (r_bot_2) -- (r_top_2);
                \draw[draw=purple, line width=1pt, line cap=round, decoration={snake, amplitude=.4mm}, decorate] (r_bot_3) -- (r_top_3);

                \draw[yellow_edge] (r_bot_1) -- (r_top_2);
                \draw[yellow_edge] (r_bot_2) -- (r_top_3);

                \draw[yellow_edge] (b_left) -- (r_top_1);
                \draw[yellow_edge] (b_right) -- (r_bot_3);
            \end{tikzpicture}
    \end{minipage}%
    \begin{minipage}[c]{0.55\textwidth}
            \begin{tikzpicture}[
                red_node/.style={circle, draw=red!70, line width=2pt, fill=red!70, minimum size=1mm, inner sep=0pt},
                blue_node/.style={circle, draw=blue!60, line width=2pt, fill=blue!60, minimum size=1mm, inner sep=0pt},
                purple_node/.style={circle, draw=purple, line width=2pt, fill=purple, minimum size=1mm, inner sep=0pt},
                green_node/.style={circle, draw=green!70!black, line width=2pt, fill=green!70!black, minimum size=1mm, inner sep=0pt},
                cyan_node/.style={circle, draw=cyan!90!black, line width=2pt, fill=green!70!black, minimum size=1mm, inner sep=0pt},
                edge_style/.style={draw=black, line width=1pt, line cap=round},
                cyan_edge/.style={draw=cyan!90!black, line width=1pt, line cap=round}
            ]

                \node[red_node] (r_bot_1) at (0, 0) {};
                \node[red_node] (r_bot_2) at (2, 0) {};
                \node[red_node] (r_bot_3) at (4, 0) {};

                \node[red_node] (r_top_1) at (0, 2.5) {};
                \node[red_node] (r_top_2) at (2, 2.5) {};
                \node[red_node] (r_top_3) at (4, 2.5) {};

                \node[blue_node] (b_left)  at (-1, 3.5) {};
                \node[blue_node] (b_right) at (5, -1.0) {};


                \draw[edge_style] (r_bot_1) -- (r_bot_2) -- (r_bot_3);
                \draw[edge_style] (r_top_1) -- (r_top_2) -- (r_top_3);

                \draw[edge_style] (r_bot_1) -- (r_top_1);
                \draw[edge_style] (r_bot_2) -- (r_top_2);
                \draw[edge_style] (r_bot_3) -- (r_top_3);

                \draw[cyan_edge] (r_bot_1) -- (r_top_2);
                \draw[cyan_edge] (r_bot_2) -- (r_top_3);

                \draw[cyan_edge] (b_left) -- (r_top_1);
                \draw[cyan_edge] (b_right) -- (r_bot_3);

                \matrix [
                    % draw=white,
                    % fill=white,
                    line width=1pt,
                    rounded corners=0pt,
                    inner sep=2pt,
                    row sep=1pt,
                    column sep=6pt,
                    right=0.5cm of r_top_3,
                    anchor=north west
                ] {
                    \node[red_node, scale=0.7] {}; & \node[anchor=west] {nasycený}; \\
                    \node[blue_node, scale=0.7] {}; & \node[anchor=west] {volný}; \\
                    \node[minimum width=0.6cm] (p_line) {}; 
                    \draw[purple, line width=1pt, decoration={snake, amplitude=.3mm, segment length=1.5mm}, decorate] (p_line.west) -- (p_line.east); 
                        & \node[anchor=west, font=\small] {párování $P$}; \\
                    \node[minimum width=0.6cm] (g_line) {}; 
                        \draw[green!70!black, line width=1pt] (g_line.west) -- (g_line.east); 
                        & \node[anchor=west, font=\small] {cesta $C$}; \\
                    \node[minimum width=0.6cm] (c_line) {}; 
                        \draw[cyan!90!black, line width=1pt] (c_line.west) -- (c_line.east); 
                        & \node[anchor=west, font=\small] {párování $P^\prime$}; \\
                };
            \end{tikzpicture}
    \end{minipage}
\end{figure}
A pokud je navíc $C$ \hyperref[zlepsujiciCestaPar]{zlepšující cesta}, tj. cesta mezi volnými vrcholy v $P$, pak 
$|P^\prime| = |P| + 1$.

\subsection{Věta o vrcholově disjunktních zlepšujících cestách}\label{berge}
\ii{Berge}. Je dáno \hyperref[parovani]{párování} $P$ v grafu $G$. Označme $P_{\max}$ 
\hyperref[maximalniParovani]{maximální párování} v $G$ (o kterém víme, že existuje). Jestliže
\begin{equation}
    |P_{\max}| = |P| + k,
\end{equation}
pak v $G$ existuje $k$ vrcholově disjunktních \hyperref[zlepsujiciCestaPar]{zlepšujících cest} vůči $P$.

Přitom alespoň jedna z těchto \hyperref[stc]{cest} je kratší než $\frac{n}{k}$, kde $n$ je počet vrcholů.

\dukaz Utvořme symetrickou diferenci hran obou párování, tj. $H = P \oplus P_{\max} = 
(P \setminus P_{\max}) \cup (P_{\max} \setminus P)$.
Uvažujme graf, který obsahuje všechny vrcholy grafu $G$ a hrany $H$. V tomto grafu má každý vrchol stupeň nejvýše 2. 
Mějme libovolný vrchol $v$. Pak nastane některé z následujicích možností:
\vspace{-1em}
\begin{enumerate}[(a)]
    \item není \hyperref[nasyceny]{nasycen} ani v $P$ ani v $P_{\max}$, pak $d_H(v) = 0$;
    \item je nasycen buď v $P$, nebo v $P_{\max}$, pak $d_H(v) = 1$;
    \item je nasycen v obou párováních, pak $d_n(v) = 0$, jestliže stejnou hranou, nebo $d_H(v) = 2$. 
\end{enumerate}
Komponenty souvislosti grafu $(V,H)$ jsou buď isolované vrcholy (stupeň 0), nebo \hyperref[kruznice]{kružnice}, nebo 
cesty. Jak v křuznicích, tak v cestách se střídají hrany z $P$ a $P_{\max}$. Proto jsou kružnice sudé délky, cesty pak 
sudé či liché délky.

Mezi komponentami souvislosti nemůže existovat \hyperref[stc]{cesta} liché délky, která by měla víc hran z $P$ než z 
$P_{\max}$ (byla by to totiž \hyperref[zlepsujiciCestaPar]{zlepšující cesta} vůči $P_{\max}$ a ta neexistuje). Každá 
cesta liché délky je proto zlepšující cestou vzhledem k párování $P$. Víme, že každá kružnice i každá cesta sudé délky 
má stejný počet hran z $P$ a $P_{\max}$. Ukážeme-li tedy, že $H$ obsahuje o $k$ více hran z $P_{\max}$ než z $P$, budeme 
mít dokázáno, že existuje $k$ komponent grafu $H$, které jsou zlepšujícími cestami vůči $P$.

Máme
\begin{equation}
    H = \left(P_{\max} \setminus P\right) \cup \left(P \setminus P_{\max}\right).
\end{equation}
Platí
\begin{equation}
    \left|P_{\max} \setminus P\right| = \left|P_{\max}\right| - \left|P \cap P_{\max}\right| = |P| + k - 
    \left|P \cap P_{\max}\right| = \left|P \setminus P_{\max}\right| + k.
\end{equation}
\hspace{\fill}\qed

\subsection{Souvislost perfektního párování a počtu komponent}\label{tutte}
\ii{Tutte}. Je dán prostý graf $G = (V,E)$ bez smyček s alespoň třemi vrcholy. V grafu $G$ existuje 
\hyperref[perfektniParovani]{perfektní párování} právě tehdy, když pro každou podmnožinu $S \subseteq V$ platí
\begin{equation} \label{eq:tutte}
    g(G \setminus S) \leq |S|, 
\end{equation}
kde $g(G \setminus S)$ je počet komponent souvislosti grafu $G \setminus S$, které mají lichý počet vrcholů.

\dukaz\\
\enquote{$\Rightarrow$}: Předpokládejme, že v grafu $G$ existuje perfektní párování (tj. párování 
\hyperref[nasyceny]{nasycující} všechny vrcholy grafu $G$). Vezměme libovolnou $S \subseteq V$. Protože v každé liché 
komponentě souvislosti grafu $G \setminus S$ je alespoň jeden vrchol, který není spárován uvnitř komponenty, musí být v 
perfektním párování spárován s nějakým vrcholem $S$. Proto nemůže být $|S|$ menší než počet lichých komponent.

\enquote{$\Leftarrow$}: Předpokládejme, že graf $G$ splňuje $g(G \setminus S) \leq |S|$ pro každou $S \subseteq V$.

Nejprve si uvědomme, že pro $S = \emptyset$ podmínka zaručuje, že graf $G$ má sudý počet vrcholů.

Dále si uvědomme, že splňuje-li $G$ podmínku \eqref{eq:tutte} a přidáme-li k němu hranu $e$ mezi stávajícimi vrcholy, 
pak graf $G + e$ také splňuje podmínku \eqref{eq:tutte}. Ano, graf $(G+e) \setminus S$ má buď stejně lichých komponent 
jako $G \setminus S$, nebo o dvě méně. 

Předpokládejme, že by existoval graf $G$ splňující \eqref{eq:tutte}, který nemá perfektní párování, tak vybereme jako 
$G$ ten z nich, který nemá perfektní párování, ale přidáním libovolné hrany už 
\hyperref[perfektniParovani]{perfektní párování} mít bude.

Označme $T$ množinu všech vrcholů stupně $n-1$, kde $n = |V|$. Platí $T \subseteq V$ a proto pro ni musí platit podmínka 
\eqref{eq:tutte}. Nejprve dokážeme, že každá komponenta souvislosti grafu $G \setminus T$ je úplný graf.

Kdyby existovala komponenta souvislosti $C$ grafu $G \setminus T$, která není úplným grafem, pak by v $C$ existovaly 
vrcholy $x,y,z$ takové, že $\bc{x,y}, \bc{y,z} \in E$ a $\bc{x,z} \not\in E$. Navíc vrchol $z$ neleží v $T$, proto 
existuje vrchol $w \not\in T$ takový, že $\bc{z,w} \not\in E$.

Označme $P_1$ perfektní párování v grafu $G + \bc{x,y}$ a $P_2$ perfektní párování v grafu $G + \bc{z,w}$. Dále označme 
$H$ symetrickou diferenci párování $P_1 \oplus P_2$. Platí $\bc{x,y}, \bc{z,w} \in H$. Rozebereme nyní dva případy:
\begin{enumerate}[(a)]
    \item Hrany $\bc{x,y}, \bc{z,w}$ leží v různých komponentách souvislosti $A, B$ v $H$, $\bc{x,y} \in A$, $\bc{z,w} 
    \in B$. Pak párování $P$, které obsahuje hrany $P_2$ komponenty $A$ jinak hrany $P_1$, je perfektní párování v grafu 
    $G$. Což je spor s faktem, že $G$ nemá perfektní párování.
    \item Hrany $\bc{x,y}, \bc{z,w}$ leží ve stejné komponentě souvislosti $A$ grafu $H$. Komponenta $A$ je 
    \hyperref[kruznice]{kružnice} sudé délky, která střídavě obsahuje hrany z $P_1$ a $P_2$. Označme $K_1$ tu část $A$, 
    která začíná ve vrcholu $z$, pokračuje z $P_1$ a po hraně z $P_2$ poprvé navštíví jeden z vrcholů $x,y$. \ii{BÚNO} 
    předpokládejme, že je to vrchol $y$. Dále označme $K_2$ zbylou část kružnice $A$, ze které jsme odstranili hranu 
    $\bc{x,y}$. Definujme $P$ takto: $P$ obsahuje
    \begin{itemize}
        \item $K_1 \cap P_2$,
        \item $K_2 \cap P_1$,
        \item $\bc{x,z}$.
    \end{itemize}
    Tím jsme získali perfektní párování v grafu $G$; opět spor.
\end{enumerate}
Víme tedy, že všechny komponenty souvislosti grafu $G \setminus T$ jsou úplné grafy. Definujme 
\hyperref[parovani]{párování} $P$ takto: \ii{V každé komponentě souvislosti grafu $G \setminus T$ o sudém počtu vrcholů 
vybereme libovolné \hyperref[perfektniParovani]{perfektní párování}; v komponentě souvislosti $G \setminus T$ o lichém 
počtu vrcholů spárujeme libovolně všechny vrcholy až na jeden, 
který spárujeme s některým vrcholem $T$.} Protože lichých komponent $G \setminus T$ je nejvyše tolik jako $|T|$, 
můžeme to udělat. Navíc je počet vrcholů sudý, takže nám z množiny $T$ zbyde sudý počet nespárovaných vrcholů, jedná 
se ovšem o vrcholy, které jsou spojeny s každým vrcholem grafu, můžeme proto zbylé vrcholy mezi sebou libovolně 
spárovat. Zase jsme ukázali, že v $G$ existuje pefektní párování.
\hspace{\fill}\qed

\subsection{Párování v bipartitních grafech}
Je dán bipartitní graf $G$ se stranami $X$ a $Y$. K němu je možné vytvořit \hyperref[sit]{síť} takovou, že každému 
\hyperref[parovani]{párování} $P$ v grafu $G$ odpovídá \hyperref[pripustnyTok]{přípustný tok} $f$, a naopak každému 
přípustnému toku $f$ v síti odpovídá párování $P$ v $G$; a to tak, že 
$\vel(f) = |P|$.
\begin{figure}[H]
    \centering
    \begin{tikzpicture}[
        vertex/.style={circle, draw, fill=white, inner sep=1pt, outer sep=0pt},
        blue_arrow/.style={->, >=Stealth, blue!70!black, thick},
        black_arrow/.style={->, >=Stealth, black, thick},
        highlight/.style={line width=7pt, yellow!50, line cap=round},
        dashed_line/.style={dotted, black!70, thick}
    ]
        \node[vertex, label=below:$s$] (s) at (0, 0) {};
        \node[vertex, label=below:$t$] (t) at (10, 0) {};

        \def\xpos{3}
        \def\ypos{7}

        \draw[dashed_line] (\xpos, 2.5) -- (\xpos, -2.5);
        \draw[dashed_line] (\ypos, 2.5) -- (\ypos, -2.5);

        \node[vertex] (x1) at (\xpos, 2.5) {};
        \node[vertex] (x2) at (\xpos, 1.2) {};
        \node[vertex] (x3) at (\xpos, -1.2) {};
        \node[vertex] (x4) at (\xpos, -2.5) {};

        \node[vertex] (y1) at (\ypos, 2.5) {};
        \node[vertex] (y2) at (\ypos, 1.2) {};
        \node[vertex] (y3) at (\ypos, -1.2) {};
        \node[vertex] (y4) at (\ypos, -2.5) {};

        \node[above=0.3cm of x1] {$X$};
        \node[above=0.3cm of y1] {$Y$};

        \begin{scope}[on background layer]
            \draw[highlight] (x1) -- (y1);
            \draw[highlight] (x2) -- (y2);
            \draw[highlight] (x3) -- (y4);
            \draw[highlight] (x4) -- (y3);
        \end{scope}

        \draw[blue_arrow] (s) -- (x1);
        \draw[blue_arrow] (s) -- (x2);
        \draw[blue_arrow] (s) -- (x3);
        \draw[blue_arrow] (s) -- (x4);
        \node[blue!70!black, font=\large] at (1.5, 0.2) {$\vdots$};
        \draw[blue_arrow] (y1) -- (t);
        \draw[blue_arrow] (y2) -- (t);
        \draw[blue_arrow] (y3) -- (t);
        \draw[blue_arrow] (y4) -- (t);
        \node[blue!70!black, font=\large] at (8.5, 0.2) {$\vdots$};

        \draw[black_arrow] (x1) -- (y1);
        \draw[black_arrow] (x2) -- (y2);
        \draw[black_arrow] (x3) -- (y4);
        \draw[black_arrow] (x4) -- (y3);
        \draw[black_arrow] (x1) -- (y2);
        \draw[black_arrow] (x2) -- (y1);
        \draw[black_arrow] (x3) -- (y3);
        \draw[black_arrow] (x2) -- (y4);
        \draw[black_arrow] (x4) -- (y2);
    \end{tikzpicture}
\end{figure}
Vytvořme síť $G^\prime$ s \hyperref[omezeniToku]{omezeními} $l,c$, zdrojem $s$, spotřebičem $t$ a hranami 
\begin{align}
    E^\prime :\quad& (s,x) \forall x \in X\\
    & (y, t) \,\forall y \in Y.
\end{align}
A dále zorientujme: $\forall \bc{x,y} \in E(G)$, $x \in X$, $y \in Y$ $E^\prime$ obsahuje $(x,y)$. Pak omezení takové 
sítě $l(e) = 0$, $c(e) = 1$, $\forall e \in E^\prime$.

Pro párování uděláme přípustný tok $f_p$, že 
\begin{equation}
    \bc{x,y} \in P: f_P((x,y))=1.
\end{equation}
Takže $|P| = \vel(f_P)$; \ii{\enquote{projde tolik jedniček, kolik je hran párování}}.

No a $\bc{x,y} \in P_f$ právě tehdy, když $f((x,y))=1$. Tedy $\vel(f) = |P_f|$.

\subsection{Věta o maximálním párování}\label{konig} % TODO: dodělat z nahrávky, 10. týden
\ii{König}. Je dán bipartitní graf $G$ se stranami $X$ a $Y$. Označme $P_{\max}$ 
\hyperref[maximalniParovani]{maximální párování} v $G$. \\ Pak platí
\begin{equation}
    |P_{\max}| = \min_{A \subseteq X} (|X \setminus A| + |V_G(A)|).
\end{equation}
\begin{figure}[H]
    \centering
    \begin{tikzpicture}[
        vertex/.style={circle, draw, fill=white, inner sep=1.5pt, outer sep=0pt},
        blue_arrow/.style={->, >=Stealth, blue!70!black, thick},
        black_arrow/.style={->, >=Stealth, black, thick},
        highlight/.style={line width=5pt, yellow!40, line cap=round},
        dashed_line/.style={dotted, black!70, thick},
        blob_style/.style={draw=purple!40, fill=purple!10, line width=2pt, rounded corners=15pt},
        pink_set/.style={draw=magenta!70, line width=1.5pt, inner sep=5pt, rounded corners=10pt}
    ]
        \node[vertex, label=left:$s$] (s) at (0, 0) {};
        \node[vertex, label=right:$t$] (t) at (10, 0) {};

        \def\xpos{3}
        \def\ypos{7}

        \draw[dashed_line] (\xpos, 2.5) -- (\xpos, -3);
        \draw[dashed_line] (\ypos, 2.5) -- (\ypos, -3);

        \node[vertex] (x1) at (\xpos, 2.5) {};
        \node[vertex] (x2) at (\xpos, 1.5) {};
        \node[vertex] (x3) at (\xpos, -1.0) {};
        \node[vertex] (x4) at (\xpos, -2.0) {};
        \node[vertex] (x5) at (\xpos, -3.0) {};

        \node[vertex] (y1) at (\ypos, 2.5) {};
        \node[vertex] (y2) at (\ypos, 1.5) {};
        \node[vertex] (y3) at (\ypos, -1.0) {};
        \node[vertex] (y4) at (\ypos, -2.0) {};
        \node[vertex] (y5) at (\ypos, -3.0) {};

        \node[above] at (\xpos, 3) {\Large $X$};
        \node[above] at (\ypos, 3) {\Large $Y$};

        \node[blue!70!black, font=\large] at (1.5, 0.5) {$\vdots$};
        \node[blue!70!black, font=\large] at (8.5, 0.5) {$\vdots$}; 
        \begin{scope}[on background layer]
            \draw[blob_style] plot [tension=0.5] coordinates {
                (-0.5, 0.3)
                (5, -0.5)
                (7.8, -0.7)
                (7.5, -4)
                (3, -4)
                (-0.5, -1)
            } -- cycle;
            
            \node[pink_set, fit=(x3)(x5), label={[magenta!80]below:$A$}] {}; 
            \node[pink_set, fit=(y3)(y5), label={[magenta!80]below:$V_G(A)$}] {}; 

            \draw[highlight] (s) -- (x1);
            \draw[highlight] (s) -- (x2);
            
            \draw[highlight] (y3) -- (t);
            \draw[highlight] (y4) -- (t);
            \draw[highlight] (y5) -- (t);
        \end{scope}
        \node[purple!40] at (1.5, -3) {$Z$};

        \draw[blue_arrow] (s) -- (x1);
        \draw[blue_arrow] (s) -- (x2);
        \draw[blue_arrow] (s) -- (x3);
        \draw[blue_arrow] (s) -- (x4);
        \draw[blue_arrow] (s) -- (x5);
        \draw[blue_arrow] (y1) -- (t);
        \draw[blue_arrow] (y2) -- (t);
        \draw[blue_arrow] (y3) -- (t);
        \draw[blue_arrow] (y4) -- (t);
        \draw[blue_arrow] (y5) -- (t);

        \draw[black_arrow] (x3) -- (y3);
        \draw[black_arrow] (x4) -- (y5);
        \draw[black_arrow] (x5) -- (y4);
        \draw[black_arrow] (x1) -- (y1);
        \draw[black_arrow] (x2) -- (y2);
        \draw[black_arrow] (x3) -- (y4);
        \draw[black_arrow] (x4) -- (y3);
        \draw[black_arrow] (x1) -- (y2);
        \draw[black_arrow] (x2) -- (y1);
        \draw[black_arrow] (x4) -- (y2);
        \draw[black_arrow] (x1) -- (y4);
    \end{tikzpicture}
\end{figure}
$Z = \bc{s} \cup A \cup V_G(A)$, $t \not\in Z$.
\begin{equation}
    W^+(Z) = \bc{(s,x) \mid x \not\in A} \cup \bc{(y,t) \mid y \in V_G(A)} = \left|\bc{(s,x) \mid x \not\in A}\right|
    + \left|\bc{(y,t) \mid y \in V_G(A)}\right|
\end{equation}
\begin{equation}
    \fcap(W(Z)) = \underbrace{\sum c(e)}_{e \in W^+(Z)}
\end{equation}
A určuje \hyperref[rezZdroj]{řez} $W(Z)$ s $\fcap(W(Z)) = |X-A| + |V_G(A)|$.

Minimální řez má tvar $Z_0 = \bc{s} \cup A_0 \cup V_G(A_0)$ pro vhodné $A_0 \subseteq X$, kde $Z_0$ je množina 
označkovaných vrcholů a $A_0 = Z_0 \cap X$.

Musíme ukázat, že $Z_0 \cap Y = V_G(A_0)$.
\begin{align}
    Z_0 \cup Y \subseteq V_G(A_0) \\
    Z_0 \cup Y \supseteq V_G(A_0)
\end{align}

\subsection{Věta o nasycujícím párování}\label{hall}
\ii{Hall}. Je dán bipartitní graf $G$ se stranami $X$ a $Y$. Pak v $G$ existuje párování nasycující stranu $X$ právě 
tehdy, když pro každou množinu $A \subseteq X$ platí
\begin{equation}
    |A| \leq |V_G(A)| = \bc{y \mid y \in Y \land \bc{x,y} \in E}.
\end{equation}
\dukaz Jestliže v grafu $G$ existuje párování nasycující stranu $X$, pak $G$ podmínku věty splňuje (párování každému 
vrcholu z množiny $A$ \enquote{přiřazuje} vrchol z $V_G(A)$, a tudíž vrcholů v $V_G(A)$ musí být alespoň tolik, kolik je 
vrcholů v $A$.) 

\enquote{$\Leftarrow$}: Víme, že $|P_{\max}| = |X \setminus A_0| + |V_G(A)|$ pro nějakou $A_0 \subseteq X$ (z 
\hyperref[konig]{Königovy věty}). \\ Sporem. Kdyby $P_{\max}$ nenasycovalo $X$. Tak $|P_{\max} < |X|$. Takže
\begin{align}
    |X \setminus A_0| + |V_G(A)| &< |X| \\
    |X| - |A_0| + |V_G(A)| &< |X| \\
    |V_G(A)| &< |A_0| 
\end{align}
Což je spor.
\hspace{\fill}\qed

\subsection{Tvrzení o vztahu stupňů vrcholů a nasycujícího párování}
Je dán bipartitní graf $G$ se stranami $X$ a $Y$. Jestliže pro každý vrchol $x \in X$ a každý vrchol $y \in Y$ platí
\begin{equation}
    d(x) \geq d(y),
\end{equation}
pak v $G$ existuje párování nasycující stranu $X$.

\begin{figure}[H]
    \centering
    \begin{tikzpicture}[
        thick,
        vertex_hollow/.style={circle, draw, very thick, minimum size=8pt, inner sep=0pt},
        vertex_filled/.style={circle, fill, minimum size=8pt, inner sep=0pt}
    ]
        \node at (0, 5.5) {$X$};
        \node at (6, 5.5) {$Y$};

        \node[vertex_hollow, draw=green!60!black, label=left:\textcolor{green!60!black}{$x$}] (x) at (0, 4.5) {};
        \fill[green!60!black] (x) circle (2pt);
        \node at (0, 3.5) {$\vdots$};
        \node at (0, 1.5) {$\vdots$};
        \node at (0, 0.5) {$\vdots$};

        \node[vertex_hollow, draw=orange, label=right:\textcolor{orange}{$y$}] (y) at (6, 4.5) {};
        \fill[orange] (y) circle (2pt); 

        \node[vertex_filled, blue] (y1) at (6, 3.5) {};
        \node[vertex_filled, blue] (y2) at (6, 2.5) {};
        \node[vertex_filled, blue] (y3) at (6, 1.5) {};
        \node[vertex_filled, blue] (y4) at (6, 0.5) {};
        
        \node at (6, -0.5) {$\vdots$};

        \draw[green!60!black, thick] (x) -- (y);
        \draw[green!60!black, thick] (x) -- (y1);
        \draw[green!60!black, thick] (x) -- (y2);
        \draw[orange, very thick] (0.5, 2.2) -- (y);
        \draw[violet, thick] (0.65, 1.8) -- (y1);
        \draw[violet, thick] (0.7, 1.2) -- (y2);
        \draw[blue!80!black, thick] (0.7, 0.8) -- (y3);
        \draw[blue!80!black, thick] (0.65, 0.2) -- (y4);
        \draw[blue!80!black, thick] (0.5, -0.2) -- (5.5, -0.2);

        \draw[violet, very thick] (0, 1) ellipse (0.7cm and 1.8cm);
        \node[text=violet] at (-1.2, 1) {$A$};
    \end{tikzpicture}
\end{figure}
\dukaz Označme $d_X = \min\bc{d(x) \mid x \in X}$ a $d_Y = \max\bc{d(y) \mid y \in Y}$. Z předpokladu víme 
\begin{equation}
    d_X \geq d_Y.    
\end{equation}
Použijme \hyperref[hall]{Hallovu větu}. Vezměme libovolnou množinu $A \subseteq X$.
\begin{align}
    W(A) &\subseteq W(V_G(A)) \\
    \text{a } |W(A)| &\geq d_X |A|, \, |W(V_G(A))| \leq d_Y |V_G(A)|
\end{align}
Takže
\begin{equation}
    d_X |A| \leq |W(A)| \leq |W(V_G(A)) \leq d_Y |V_G(A)|
\end{equation}
a současně $d_X \geq d_Y$.

Může být $|A| > |V_G(A)|$? Kdyby ano, tak
\begin{equation}
    d_X |A| > d_Y |V_G(A)|.
\end{equation}
Což neplatí, takže
\begin{equation}
    |A| \leq |V_G(A)|.
\end{equation}
A tedy \hyperref[hall]{Hallova věta} říká, že existuje párování nasycující $X$.
\hspace{\fill}\qed

\subsection{Tvrzení o existenci nasycujícího párování všech vrcholů}
Je dán bipartitní graf $G$ se stranami $X$ a $Y$. Pak existuje párování, které nasycuje všechny vrcholy nejvyššího 
stupně.

\dusledek Je dán bipartitní graf $G = (V,E)$ se stranami $X$ a $Y$. Označme $\Delta(G)$ nejvyšší stupeň, který některý 
vrchol grafu má. Pak množinu hran $E$ je možno rozdělit na $\Delta(G)$ hranově disjunktních párování. 

\dukaz Vytořme $G^\prime$, že k němu přidáme hrany a vrchol tak, aby
\begin{equation}
    \Delta(G) = d_{G^\prime}(x) = d_{G^\prime} (y) \, \forall x\in X, \, \forall y \in Y.
\end{equation}
V novém grafu $G^\prime$, protože
\begin{equation}
    d_{G^\prime}(x) \geq d_{G^\prime}(y) \, \forall x \in X, \, \forall y \in Y, 
\end{equation}
existuje párování nasycující $X$.

Vybrali jsme maximální párování $P_{\max}$. Odstraníme všechny hrany neležící v $G$.

Musí zůstat nasyceny ty vrcholy, které měly největší stupeň. Tím dostaneme párování $P$ nasycující vrcholy nejvyššího 
stupně. 
\hspace{\fill}\qed
